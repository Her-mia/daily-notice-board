<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>daily-notice-broad</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="style.css">

</head>

<body>

    <div class="theme-selector">
        <label>主题颜色：</label>
        <select id="themeSelect">
            <option value="blue">蓝色</option>
            <option value="pink">粉色</option>
            <option value="green">绿色</option>
            <option value="purple">紫色</option>
            <option value="blackgold">黑金</option>
        </select>
    </div>

    <div class="top">
        <div class="weather-grid">
            {# 第一行：白天天气 #}
            {% for w in data.weather %}
            <div class="weather-grid div">
                <div>{{ w.date }}</div>
                <img src="{{ url_for('static', filename='img/' + w.day_weather[2]) }}">
            </div>
            {% endfor %}

            {# 第二行：夜间天气 #}
            {% for w in data.weather %}
            <div class="weather-grid div">
                <div>{{ w.date }}</div>
                <img src="{{ url_for('static', filename='img/' + w.night_weather[2]) }}">
            </div>
            {% endfor %}
        </div>
    </div>


    </div>
    </div>





    <div class="bottom-container">
        <div class="bottom-left">
            <div class="add-date">
                <form action="/set_date" method="POST">
                    <input type="text" name="event_name" placeholder="事件名称，例如：生日" required>
                    <input type="date" name="target_date" placeholder="选择日期" required>
                    <button type="submit">设置目标日期</button>
                </form>
            </div>

            {% if data.events %}
            <div class="events-grid">
                {% for name, days in data.events.items() %}
                <div class="event-card">

                    <form action="/delete_event/{{ name }}" method="POST" class="delete-form"> 
                        <button class="delete-btn">x</button> 
                    </form>

                    <form action="/delete_event/{{ name }}" method="POST" class="delete-form">
                        <button class="delete-btn">x</button>
                    </form>

                    <!-- 上半部分：事件名称（动态变色） -->
                    <div class="event-top {% if days < 10 %}danger{% elif days < 30 %}warning{% else %}normal{% endif %}">
                        {{ name }}
                    </div>

                    <!-- 下半部分：剩余天数（固定灰色） -->
                    <div class="event-bottom">
                        还有 {{ days }} 天
                    </div>

                </div>
                {% endfor %}

            </div>

            {% else %}
            <p>还没有添加任何事件</p>
            {% endif %}
        </div>


        <div class="bottom-right">
            <div class="timer">

                <h1>倒计时</h1>
                <div id="timer">
                    <h1>...<h1>
                </div>
                <input type="number" id="minutes" min="1" max="180">
                <button onclick="setCountdown()">开始倒计时</button>

                <div id="msg" style="color:red;"></div>


            </div>
            <div class="road">
                <img src="{{ url_for('static', filename='img/car.png') }}" class="car">
            </div>
            <script src="{{ url_for('static', filename='timer.js') }}"></script>



        </div>

    </div>

    </div>


    </div>
    <script>
    const themeSelect = document.getElementById("themeSelect");

    // 页面加载时读取主题
    const savedTheme = localStorage.getItem("theme");
    if (savedTheme) {
        themeSelect.value = savedTheme;
        applyTheme(savedTheme);
    }

    // 切换主题
    themeSelect.addEventListener("change", function() {
    const theme = this.value;
    localStorage.setItem("theme", theme);
    applyTheme(theme);
});

// 应用主题
    function applyTheme(theme) {
    switch(theme) {
        case "blue":
            document.documentElement.style.setProperty("--theme-normal", "linear-gradient(135deg, #020617, #0b1e3f)");
            break;
        case "pink":
            document.documentElement.style.setProperty("--theme-normal", "linear-gradient(135deg, #f48fb1, #f06292)");
            break;
        case "green":
            document.documentElement.style.setProperty("--theme-normal", "linear-gradient(135deg, #81c784, #66bb6a)");
            break;
        case "purple":
            document.documentElement.style.setProperty("--theme-normal", "linear-gradient(135deg, #9575cd, #7e57c2)");
            break;
        case "blackgold":
            document.documentElement.style.setProperty("--theme-normal", "linear-gradient(135deg, #2c2c2c, #000000)");
            break;
    }
}
    </script>



</body>

</html>